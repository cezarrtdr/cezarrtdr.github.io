<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automatización Topográfica: Python + Civil 3D</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Merriweather:ital,wght@0,300;0,400;0,700;1,300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />

    <style>
        /* ESTILO GENERAL: GITHUB DARK MODE */
        :root {
            --bg-github: #0d1117;
            --text-primary: #c9d1d9;
            --text-secondary: #8b949e;
            --accent-blue: #58a6ff;
            --accent-green: #238636;
            --border-color: #30363d;
            --code-bg: #161b22;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background-color: var(--bg-github);
            color: var(--text-primary);
            font-family: 'Merriweather', serif; 
            line-height: 1.9;
            font-size: 18px;
            padding: 40px 20px;
        }

        /* Enlace de volver */
        .back-link {
            text-decoration: none; color: var(--text-secondary);
            font-family: 'Inter', sans-serif; font-size: 0.9rem;
            display: inline-flex; align-items: center; gap: 8px;
            margin-bottom: 40px; transition: 0.2s;
        }
        .back-link:hover { color: var(--accent-blue); }

        /* Contenedor Central */
        .paper-container { max-width: 960px; margin: 0 auto 100px auto; }

        /* Tipografía */
        h1, h2, h3 {
            font-family: 'Inter', sans-serif; color: #ffffff;
            font-weight: 700; line-height: 1.3;
        }

        header { border-bottom: 1px solid var(--border-color); padding-bottom: 30px; margin-bottom: 40px; }
        h1 { font-size: 2.8rem; margin-bottom: 20px; letter-spacing: -0.5px; }

        .meta-data {
            font-family: 'Inter', sans-serif; color: var(--text-secondary);
            font-size: 0.95rem; display: flex; flex-wrap: wrap; gap: 25px;
        }
        .meta-data span { display: flex; align-items: center; gap: 8px; }
        .meta-data i { color: var(--accent-blue); }

        h2 { font-size: 1.8rem; margin-top: 50px; margin-bottom: 20px; border-left: 4px solid var(--accent-blue); padding-left: 15px; }
        h3 { font-size: 1.4rem; margin-top: 30px; margin-bottom: 15px; color: var(--text-primary); }
        p { margin-bottom: 25px; }
        strong { color: white; font-weight: 700; }
        
        ul { margin-bottom: 30px; padding-left: 25px; }
        li { margin-bottom: 12px; }

        /* --- ESTILOS DE LA CAJA DE CÓDIGO --- */
        .code-window {
            background-color: var(--code-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin: 30px 0;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        
        .code-header {
            background-color: #21262d;
            padding: 10px 20px;
            font-family: 'Inter', sans-serif; font-size: 0.85rem;
            color: var(--text-secondary);
            border-bottom: 1px solid var(--border-color);
            display: flex; justify-content: space-between; align-items: center;
        }

        .header-left { display: flex; align-items: center; gap: 15px; }
        
        .dots { display: flex; gap: 6px; }
        .dot { width: 10px; height: 10px; border-radius: 50%; }
        .red { background-color: #ff5f56; }
        .yellow { background-color: #ffbd2e; }
        .green { background-color: #27c93f; }

        /* Botón de Copiar */
        .copy-btn {
            background-color: transparent;
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            padding: 5px 12px;
            font-size: 0.8rem;
            border-radius: 4px;
            cursor: pointer;
            display: flex; align-items: center; gap: 6px;
            transition: all 0.2s ease;
            font-family: 'Inter', sans-serif;
        }
        .copy-btn:hover {
            background-color: #30363d;
            color: var(--text-primary);
            border-color: var(--text-secondary);
        }

        /* Imágenes y Grillas */
        figure { margin: 50px 0; }
        img { width: 100%; height: auto; display: block; border-radius: 4px; border: 1px solid var(--border-color); }
        figcaption {
            text-align: center; font-family: 'Inter', sans-serif; font-size: 0.9rem;
            color: var(--text-secondary); margin-top: 15px; font-style: italic;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 40px 0;
        }
        @media (max-width: 768px) { .grid-2 { grid-template-columns: 1fr; } }

        /* Sección de Descargas */
        .resources-section { margin-top: 80px; padding-top: 40px; border-top: 1px solid var(--border-color); }
        .btn-download {
            display: inline-flex; align-items: center; gap: 10px;
            background-color: #238636; color: #ffffff;
            padding: 10px 20px; text-decoration: none;
            font-family: 'Inter', sans-serif; font-weight: 600; font-size: 0.95rem;
            border-radius: 6px; border: 1px solid rgba(255,255,255,0.1);
            transition: 0.2s; margin-right: 15px; margin-bottom: 10px;
        }
        .btn-download:hover { background-color: #2ea043; }
        .btn-repo { background-color: #21262d; color: var(--accent-blue); border: 1px solid var(--border-color); }
        .btn-repo:hover { background-color: #30363d; }
    </style>
</head>
<body>

    <main class="paper-container">
        
        <a href="index.html" class="back-link">
            <i class="fas fa-arrow-left"></i> Volver al Portafolio
        </a>

        <header>
            <h1>Automatización de Flujos Topográficos: Integración Python + Civil 3D</h1>
            
            <div class="meta-data">
                <span><i class="fas fa-user-circle"></i> César Torres</span>
                <span><i class="far fa-calendar-alt"></i> Enero 2026</span>
                <span><i class="fas fa-code"></i> Python & GIS</span>
                <span><i class="fas fa-layer-group"></i> Ingeniería Ambiental</span>
            </div>
        </header>

        <h2>1. El Problema: "El dolor de cabeza del CSV"</h2>
        <p>
            Cualquiera que haya trabajado en topografía o catastro conoce la historia: recibes un archivo CSV con coordenadas, lo importas a Civil 3D o ArcGIS, y ahí empieza el trabajo manual. Tienes que unir puntos, crear polilíneas, cerrar polígonos, verificar que no haya cruces y, finalmente, calcular áreas y perímetros manualmente para llenar el cuadro técnico.
        </p>
        <p>
            Realicé este ejercicio de forma tradicional utilizando <strong>AutoCAD Civil 3D</strong> y <strong>ArcGIS Pro</strong>. La verdad es que, aunque son herramientas potentes, el proceso de importación y dibujo manual es lento y propenso a errores humanos, especialmente cuando se trata de polígonos irregulares complejos o grandes volúmenes de datos.
        </p>
        <p>
            <strong>La solución:</strong> Decidí automatizar la fase de procesamiento de datos utilizando Python. El objetivo era transformar coordenadas crudas en geometría lista para ingeniería en menos de un segundo.
        </p>

        <div class="code-window">
            <div class="code-header">
                <div class="header-left">
                    <div class="dots">
                        <span class="dot red"></span>
                        <span class="dot yellow"></span>
                        <span class="dot green"></span>
                    </div>
                    <span>script_procesamiento_geospacial.py</span>
                </div>
                
                <button class="copy-btn" onclick="copiarCodigo()">
                    <i class="far fa-copy"></i> Copiar
                </button>
            </div>

            <pre><code class="language-python">import pandas as pd
import geopandas as gpd
from shapely.geometry import Polygon
import os

# 1. Carga de Datos
ruta_csv = "Coordenadas_Predio.csv"
df = pd.read_csv(ruta_csv)

# 2. Geometría
# Se agrupan las columnas X e Y en una lista de tuplas (pares de coordenadas)
lista_vertices = list(zip(df['Este_X'], df['Norte_Y']))
geometria_poligono = Polygon(lista_vertices)

# 3. Creación del GeoDataFrame
gdf = gpd.GeoDataFrame(
    {'ID': [1], 'Nombre': ['Fundo_Santa_Rosa_Irregular']}, 
    geometry=[geometria_poligono]
)

# 4. Georreferenciación
# Se define explícitamente el sistema WGS 84 / UTM zone 18S
gdf.set_crs(epsg=32718, inplace=True)

# 5. Cálculo de Atributos
# Área en Hectáreas y Perímetro en Kilómetros
gdf['Area_Ha'] = round(gdf.area / 10000, 4)
gdf['Perim_Km'] = round(gdf.length / 1000, 4)

# Funcionalidad Extra: Centroide (útil para etiquetas en planos)
gdf['Centro_X'] = round(gdf.centroid.x, 2)
gdf['Centro_Y'] = round(gdf.centroid.y, 2)

# 6. Exportar
carpeta_salida = "Resultado_GIS"
if not os.path.exists(carpeta_salida):
    os.makedirs(carpeta_salida)

ruta_shp = f"{carpeta_salida}/Predio_Final.shp"
gdf.to_file(ruta_shp)

print(f"Shapefile guardado en: {ruta_shp}")
print(gdf.drop(columns='geometry'))</code></pre>
        </div>

        <h2>2. Flujo de Trabajo Comparativo</h2>
        <p>
            Una vez ejecutado el script, obtuve un archivo <code>.shp</code> que contenía no solo la geometría perfecta, sino también la base de datos (DBF) con el área y perímetro ya calculados. Esto cambió drásticamente el flujo de trabajo en los softwares de ingeniería.
        </p>

        <h3>Validación en Software (La Prueba de Fuego)</h3>
        <p>
            Para validar la precisión del código, importé los resultados tanto en Civil 3D como en ArcGIS. La diferencia fue notable: en lugar de dibujar, simplemente utilicé los comandos de importación geoespacial y toda la información apareció lista para la maquetación.
        </p>

        <div class="grid-2">
            <figure style="margin: 0;">
                <img src="Civil_GIS/Captura_civil.png" alt="Interfaz Civil 3D">
                <figcaption>Fig 1. Importación en Civil 3D usando MAPIMPORT (Datos vinculados).</figcaption>
            </figure>
            <figure style="margin: 0;">
                <img src="Civil_GIS/captura_arcgis.png" alt="Interfaz ArcGIS Pro">
                <figcaption>Fig 2. Validación espacial en ArcGIS sobre imagen satelital.</figcaption>
            </figure>
        </div>

        <h2>3. Resultados Finales</h2>
        <p>
            Gracias a la automatización, pude dedicar el tiempo ahorrado en el dibujo a la presentación y el análisis. Aquí presento los dos entregables finales generados a partir de la misma fuente de datos procesada con Python.
        </p>

        <ul>
            <li><strong>Civil 3D:</strong> Utilizado para el Plano Perimétrico Técnico, aprovechando la generación automática de grillas y cuadros de construcción.</li>
            <li><strong>ArcGIS:</strong> Utilizado para el Mapa de Ubicación, aprovechando sus capacidades cartográficas y mapas base.</li>
        </ul>


        <div class="env-map">
        <h3>1. Plano Perimétrico (Ingeniería de Detalle) (TWI)</h3>
        <div class="env-desc">
            
        <img src="Civil_GIS/santa_rosa.png" alt="Mapa TWI">
        <p style="font-size: 0.9rem; font-style: italic; text-align: center;">Figura 3.Visualización del plano perimétrico del predio Santa Rosa</p>
    </div>

    <div class="env-map">
        <h3>2. Mapa de Ubicación (Contexto Territorial)</h3>
        <div class="env-desc">
           
        <img src="Civil_GIS/Predio_Santa_Rosa.jpg" alt="Mapa Erosión LS">
        <p style="font-size: 0.9rem; font-style: italic; text-align: center;">Figura $.Visualización del plano de ubicación del predio Santa Rosa.</p>
    </div>





        <h2>4. Conclusión</h2>
        <p>
            La integración de <strong>Python</strong> en el flujo de trabajo de la Ingeniería Ambiental y Civil no es solo un lujo, es una necesidad de eficiencia. 
        </p>
        <p>
            Mientras que el método manual me tomaba cerca de 20 minutos entre importar puntos, dibujar y verificar errores topológicos; el script de Python realiza el procesamiento geométrico y cálculo de atributos en <strong>0.8 segundos</strong>. Esto garantiza la integridad de los datos: lo que se calcula es exactamente lo que se dibuja.
        </p>

        <div class="resources-section">
            <h3>Recursos del Proyecto</h3>
            <p>Puedes acceder al código fuente y a los archivos PDF de los planos a continuación.</p>
            
            <a href="https://github.com/cezarrtdr/Civil_GIS" class="btn-download btn-repo"><i class="fab fa-github"></i> Ver Repositorio</a>
        </div>

    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>

    <script>
        function copiarCodigo() {
            // 1. Obtiene el texto del código
            const codigo = document.querySelector('code').innerText;
            
            // 2. Copia al portapapeles
            navigator.clipboard.writeText(codigo).then(() => {
                
                // 3. Feedback visual en el botón
                const boton = document.querySelector('.copy-btn');
                const originalHTML = boton.innerHTML;
                
                boton.innerHTML = '<i class="fas fa-check"></i> ¡Copiado!';
                boton.style.borderColor = '#238636';
                boton.style.color = '#238636';

                // 4. Restaurar botón a los 2 segundos
                setTimeout(() => {
                    boton.innerHTML = '<i class="far fa-copy"></i> Copiar';
                    boton.style.borderColor = '';
                    boton.style.color = '';
                }, 2000);

            }).catch(err => {
                console.error('Error al copiar:', err);
                alert('No se pudo copiar el código automáticamente.');
            });
        }
    </script>

</body>
</html>